<script type="text/ng-template" id="tree_children_renderer.html">

  <div ui-tree-handle>
    <tree-item
        item="item"
        type="'category'">
    </tree-item>
  </div>

  <div ui-tree-nodes="treeOptions"
       ng-model="item.categories"
       ng-class="{hidden: collapsed}">
    <div class="tree-row">
      <div ng-repeat="item in item.categories"
           ui-tree-node
           ng-include="'tree_children_renderer.html'"
           data-collapsed="!item.expanded">
      </div>
    </div>
  </div>

</script>

<!--search-->
<div class="form-group">
  <input type="text"
         class="form-control"
         ng-model="$ctrl.searchModel"
         placeholder="Search">
</div><!--END: search-->

<!-- tree header -->
<div class="tree-header">
  <div class="tree-header-title">
    {{($ctrl.categories.categories | filter:{name: $ctrl.searchModel, lang: $ctrl.language.code}).length + ($ctrl.categories.articles | filter:{question: $ctrl.searchModel, lang: $ctrl.language.code}).length}}
    result{{($ctrl.categories.categories.length + $ctrl.categories.articles.length)>1 ? 's' : ''}}
  </div>

  <div class="tree-header-update">
    <div class="dropdown-toggle"
         data-toggle="dropdown">
      <i class="fa fa-angle-down pull-right"></i>
      Sort by: <span class="sort">{{$ctrl.sort.name}}</span>
    </div>

    <ul class="dropdown-menu">
      <li ng-repeat="item in $ctrl.sorting" ng-click="$ctrl.changeOrder(item)">{{item.name}}</li>
    </ul>
  </div>

  <div class="tree-header-lang">
    <div class="dropdown-toggle"
         data-toggle="dropdown">
      <i class="fa fa-angle-down pull-right"></i>
      Language: <span class="sort">{{$ctrl.language.name}}</span>
    </div>

    <ul class="dropdown-menu">
      <li ng-repeat="item in $ctrl.languages" ng-click="$ctrl.language = item">{{item.name}}</li>
    </ul>
  </div>

  <div class="tree-header-author">
    Author
  </div>
  <div class="tree-header-actions">
  </div>
</div> <!--END: tree header-->

<!--tree-->
<div class="tree">
  <div ui-tree="$ctrl.treeOptions"
       data-empty-placeholder-enabled="false"
       data-nodrop-enabled="false"
       data-drag-enabled="false">
    <div ui-tree-nodes
         ng-model="$ctrl.categories.categories">

      <!--categories-->
      <div ng-repeat="item in $ctrl.categories.categories | filter:{name: $ctrl.searchModel, lang: $ctrl.language.code} | orderBy: $ctrl.sort.cat"
           ui-tree-node
           ng-include="'tree_children_renderer.html'"
           data-collapsed="!item.expanded">
      </div>

      <!--articles-->
      <div ng-repeat="article in $ctrl.categories.articles | filter:{question: $ctrl.searchModel, lang: $ctrl.language.code} | orderBy: $ctrl.sort.faq">
        <div>
          <tree-item
              item="article"
              type="'faq'">
          </tree-item>
        </div>
      </div>

    </div>
  </div>
</div><!--END:tree-->
